{% from "bootstrap5/form.html" import render_form %} {% block content %} {%
include "header.html" %}


<!-- Page Header -->
<header
        class="masthead"
        style="background-image: url('../static/assets/img/login-bg.jpg')">
    <div class="container position-relative px-4 px-lg-5">
        <div class="row gx-4 gx-lg-5 justify-content-center">
            <div class="col-md-10 col-lg-8 col-xl-7">
                <div class="page-heading">
                    <h1>Log In</h1>
                    <span class="subheading">Welcome Back!</span>
                </div>
            </div>
        </div>
    </div>
</header>

<main class="mb-4">
    <div class="container">
        <div class="row">
            <!-- : add a flash message here for users registering twice -->
             {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            {% for category, message in messages %}
            <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert" id="flash-message-{{ loop.index }}">
                <div class="w-100 text-center">
                {{ message }}
                </div>
            </div>
            <script>
                setTimeout(function() {
                    var msg = document.getElementById('flash-message-{{ loop.index }}');
                    if (msg) { msg.style.display = 'none'; }
                }, 5000);
            </script>

            <!-- üëá Add this script block at the bottom of the same <main> -->
            <script>
                document.addEventListener('DOMContentLoaded', function() {
                    const passwordInput = document.getElementById('password');
                    if (!passwordInput) return;

                    // Create toggle icon
                    const toggle = document.createElement('span');
                    toggle.innerHTML = 'üëÅÔ∏è';
                    toggle.style.position = 'absolute';
                    toggle.style.right = '15px';
                    toggle.style.top = '50%';
                    toggle.style.transform = 'translateY(-50%)';
                    toggle.style.cursor = 'pointer';

                    // Wrap field for positioning
                    const wrapper = document.createElement('div');
                    wrapper.style.position = 'relative';
                    passwordInput.parentNode.insertBefore(wrapper, passwordInput);
                    wrapper.appendChild(passwordInput);
                    wrapper.appendChild(toggle);

                    // Toggle password visibility
                    toggle.addEventListener('click', () => {
                        const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
                        passwordInput.setAttribute('type', type);
                        toggle.innerHTML = type === 'password' ? 'üëÅÔ∏è' : 'üôà';
                    });
                });
            </script>
            {% endfor %}
            {% endif %}
            {% endwith %}
            <div class="col-lg-8 col-md-10 mx-auto">
                <!--: render a login form here-->
                {{ render_form(form, novalidate=True, button_map={"submit": "primary"})}}
            </div>
        </div>
    </div>
</main>

{% include "footer.html" %} {% endblock %}
